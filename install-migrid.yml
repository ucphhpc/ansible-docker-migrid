#this will prepare MiGrid for being able to run on this server. Setting up environment and fetching stuff, and linking stuff.
#ansible-playbook --ask-vault-pass -i inventory.yml -l host -u ansib install-migrid.yml
---
- name: install docker-migrid
  hosts:
    - all
  gather_facts: true
  become: true
  roles:
    - setup_vars
    - migrid_logrotate
    - when: logrotate_enable is defined and logrotate_enable == true
    - migrid_users
    - role: setup_docker_migrid
      docker_mig_uid: "{{ migrid_user_uid }}"
      docker_mig_gid: "{{ migrid_user_gid }}"
      user: "{{ migrid_adm }}"
    - role: promtail_migrid
      when: promtail_enable is defined and promtail_enable == true
    - role: migrid_logstash_gdp
      when: logstash_enable is defined and logstash_enable == true
